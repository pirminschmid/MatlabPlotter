% Example: natural cubic splines
% Code generated by natcsi.cpp
figure('Name','Natural CSI');
f = @(x) exp(sin(2.*pi.*x));
x = linspace(-3,3,600);
plot(x,f(x),'b-');
hold on;
x = [-3, -2.9, -2.8, -2.7, -2.6, -2.5, -2.4, -2.3, -2.2, -2.1, -2, -1.9, -1.8, -1.7, -1.6, -1.5, -1.4, -1.3, -1.2, -1.1, -1, -0.9, -0.8, -0.7, -0.6, -0.5, -0.4, -0.3, -0.2, -0.1, 0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1, 1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8, 2.9, 3];
y = [1, 1.8, 2.58844, 2.58844, 1.8, 1, 0.555556, 0.386333, 0.386333, 0.555556, 1, 1.8, 2.58844, 2.58844, 1.8, 1, 0.555556, 0.386333, 0.386333, 0.555556, 1, 1.8, 2.58844, 2.58844, 1.8, 1, 0.555556, 0.386333, 0.386333, 0.555556, 1, 1.8, 2.58844, 2.58844, 1.8, 1, 0.555556, 0.386333, 0.386333, 0.555556, 1, 1.8, 2.58844, 2.58844, 1.8, 1, 0.555556, 0.386333, 0.386333, 0.555556, 1, 1.8, 2.58844, 2.58844, 1.8, 1, 0.555556, 0.386333, 0.386333, 0.555556, 1];
plot(x,y,'b*');
x = [-3, -2.98998, -2.97997, -2.96995, -2.95993, -2.94992, -2.9399, -2.92988, -2.91987, -2.90985, -2.89983, -2.88982, -2.8798, -2.86978, -2.85977, -2.84975, -2.83973, -2.82972, -2.8197, -2.80968, -2.79967, -2.78965, -2.77963, -2.76962, -2.7596, -2.74958, -2.73957, -2.72955, -2.71953, -2.70952, -2.6995, -2.68948, -2.67947, -2.66945, -2.65943, -2.64942, -2.6394, -2.62938, -2.61937, -2.60935, -2.59933, -2.58932, -2.5793, -2.56928, -2.55927, -2.54925, -2.53923, -2.52922, -2.5192, -2.50918, -2.49917, -2.48915, -2.47913, -2.46912, -2.4591, -2.44908, -2.43907, -2.42905, -2.41903, -2.40902, -2.399, -2.38898, -2.37896, -2.36895, -2.35893, -2.34891, -2.3389, -2.32888, -2.31886, -2.30885, -2.29883, -2.28881, -2.2788, -2.26878, -2.25876, -2.24875, -2.23873, -2.22871, -2.2187, -2.20868, -2.19866, -2.18865, -2.17863, -2.16861, -2.1586, -2.14858, -2.13856, -2.12855, -2.11853, -2.10851, -2.0985, -2.08848, -2.07846, -2.06845, -2.05843, -2.04841, -2.0384, -2.02838, -2.01836, -2.00835, -1.99833, -1.98831, -1.9783, -1.96828, -1.95826, -1.94825, -1.93823, -1.92821, -1.9182, -1.90818, -1.89816, -1.88815, -1.87813, -1.86811, -1.8581, -1.84808, -1.83806, -1.82805, -1.81803, -1.80801, -1.798, -1.78798, -1.77796, -1.76795, -1.75793, -1.74791, -1.7379, -1.72788, -1.71786, -1.70785, -1.69783, -1.68781, -1.6778, -1.66778, -1.65776, -1.64775, -1.63773, -1.62771, -1.6177, -1.60768, -1.59766, -1.58765, -1.57763, -1.56761, -1.5576, -1.54758, -1.53756, -1.52755, -1.51753, -1.50751, -1.4975, -1.48748, -1.47746, -1.46745, -1.45743, -1.44741, -1.4374, -1.42738, -1.41736, -1.40735, -1.39733, -1.38731, -1.3773, -1.36728, -1.35726, -1.34725, -1.33723, -1.32721, -1.3172, -1.30718, -1.29716, -1.28715, -1.27713, -1.26711, -1.2571, -1.24708, -1.23706, -1.22705, -1.21703, -1.20701, -1.19699, -1.18698, -1.17696, -1.16694, -1.15693, -1.14691, -1.13689, -1.12688, -1.11686, -1.10684, -1.09683, -1.08681, -1.07679, -1.06678, -1.05676, -1.04674, -1.03673, -1.02671, -1.01669, -1.00668, -0.996661, -0.986644, -0.976628, -0.966611, -0.956594, -0.946578, -0.936561, -0.926544, -0.916528, -0.906511, -0.896494, -0.886477, -0.876461, -0.866444, -0.856427, -0.846411, -0.836394, -0.826377, -0.816361, -0.806344, -0.796327, -0.786311, -0.776294, -0.766277, -0.75626, -0.746244, -0.736227, -0.72621, -0.716194, -0.706177, -0.69616, -0.686144, -0.676127, -0.66611, -0.656093, -0.646077, -0.63606, -0.626043, -0.616027, -0.60601, -0.595993, -0.585977, -0.57596, -0.565943, -0.555927, -0.54591, -0.535893, -0.525876, -0.51586, -0.505843, -0.495826, -0.48581, -0.475793, -0.465776, -0.45576, -0.445743, -0.435726, -0.42571, -0.415693, -0.405676, -0.395659, -0.385643, -0.375626, -0.365609, -0.355593, -0.345576, -0.335559, -0.325543, -0.315526, -0.305509, -0.295492, -0.285476, -0.275459, -0.265442, -0.255426, -0.245409, -0.235392, -0.225376, -0.215359, -0.205342, -0.195326, -0.185309, -0.175292, -0.165275, -0.155259, -0.145242, -0.135225, -0.125209, -0.115192, -0.105175, -0.0951586, -0.0851419, -0.0751252, -0.0651085, -0.0550918, -0.0450751, -0.0350584, -0.0250417, -0.015025, -0.00500835, 0.00500835, 0.015025, 0.0250417, 0.0350584, 0.0450751, 0.0550918, 0.0651085, 0.0751252, 0.0851419, 0.0951586, 0.105175, 0.115192, 0.125209, 0.135225, 0.145242, 0.155259, 0.165275, 0.175292, 0.185309, 0.195326, 0.205342, 0.215359, 0.225376, 0.235392, 0.245409, 0.255426, 0.265442, 0.275459, 0.285476, 0.295492, 0.305509, 0.315526, 0.325543, 0.335559, 0.345576, 0.355593, 0.365609, 0.375626, 0.385643, 0.395659, 0.405676, 0.415693, 0.42571, 0.435726, 0.445743, 0.45576, 0.465776, 0.475793, 0.48581, 0.495826, 0.505843, 0.51586, 0.525876, 0.535893, 0.54591, 0.555927, 0.565943, 0.57596, 0.585977, 0.595993, 0.60601, 0.616027, 0.626043, 0.63606, 0.646077, 0.656093, 0.66611, 0.676127, 0.686144, 0.69616, 0.706177, 0.716194, 0.72621, 0.736227, 0.746244, 0.75626, 0.766277, 0.776294, 0.786311, 0.796327, 0.806344, 0.816361, 0.826377, 0.836394, 0.846411, 0.856427, 0.866444, 0.876461, 0.886477, 0.896494, 0.906511, 0.916528, 0.926544, 0.936561, 0.946578, 0.956594, 0.966611, 0.976628, 0.986644, 0.996661, 1.00668, 1.01669, 1.02671, 1.03673, 1.04674, 1.05676, 1.06678, 1.07679, 1.08681, 1.09683, 1.10684, 1.11686, 1.12688, 1.13689, 1.14691, 1.15693, 1.16694, 1.17696, 1.18698, 1.19699, 1.20701, 1.21703, 1.22705, 1.23706, 1.24708, 1.2571, 1.26711, 1.27713, 1.28715, 1.29716, 1.30718, 1.3172, 1.32721, 1.33723, 1.34725, 1.35726, 1.36728, 1.3773, 1.38731, 1.39733, 1.40735, 1.41736, 1.42738, 1.4374, 1.44741, 1.45743, 1.46745, 1.47746, 1.48748, 1.4975, 1.50751, 1.51753, 1.52755, 1.53756, 1.54758, 1.5576, 1.56761, 1.57763, 1.58765, 1.59766, 1.60768, 1.6177, 1.62771, 1.63773, 1.64775, 1.65776, 1.66778, 1.6778, 1.68781, 1.69783, 1.70785, 1.71786, 1.72788, 1.7379, 1.74791, 1.75793, 1.76795, 1.77796, 1.78798, 1.798, 1.80801, 1.81803, 1.82805, 1.83806, 1.84808, 1.8581, 1.86811, 1.87813, 1.88815, 1.89816, 1.90818, 1.9182, 1.92821, 1.93823, 1.94825, 1.95826, 1.96828, 1.9783, 1.98831, 1.99833, 2.00835, 2.01836, 2.02838, 2.0384, 2.04841, 2.05843, 2.06845, 2.07846, 2.08848, 2.0985, 2.10851, 2.11853, 2.12855, 2.13856, 2.14858, 2.1586, 2.16861, 2.17863, 2.18865, 2.19866, 2.20868, 2.2187, 2.22871, 2.23873, 2.24875, 2.25876, 2.26878, 2.2788, 2.28881, 2.29883, 2.30885, 2.31886, 2.32888, 2.3389, 2.34891, 2.35893, 2.36895, 2.37896, 2.38898, 2.399, 2.40902, 2.41903, 2.42905, 2.43907, 2.44908, 2.4591, 2.46912, 2.47913, 2.48915, 2.49917, 2.50918, 2.5192, 2.52922, 2.53923, 2.54925, 2.55927, 2.56928, 2.5793, 2.58932, 2.59933, 2.60935, 2.61937, 2.62938, 2.6394, 2.64942, 2.65943, 2.66945, 2.67947, 2.68948, 2.6995, 2.70952, 2.71953, 2.72955, 2.73957, 2.74958, 2.7596, 2.76962, 2.77963, 2.78965, 2.79967, 2.80968, 2.8197, 2.82972, 2.83973, 2.84975, 2.85977, 2.86978, 2.8798, 2.88982, 2.89983, 2.90985, 2.91987, 2.92988, 2.9399, 2.94992, 2.95993, 2.96995, 2.97997, 2.98998, 3];
y = [1, 1.07629, 1.1528, 1.22979, 1.30748, 1.38611, 1.4659, 1.5471, 1.62994, 1.71465, 1.80146, 1.89036, 1.98033, 2.07014, 2.15855, 2.24431, 2.32619, 2.40295, 2.47334, 2.53614, 2.59009, 2.63419, 2.6683, 2.69244, 2.70667, 2.71102, 2.70553, 2.69024, 2.6652, 2.63043, 2.58599, 2.53211, 2.46972, 2.39991, 2.32375, 2.24232, 2.1567, 2.06797, 1.97721, 1.8855, 1.79392, 1.70339, 1.61435, 1.52712, 1.44203, 1.35941, 1.27957, 1.20286, 1.1296, 1.06011, 0.994715, 0.933647, 0.876791, 0.823974, 0.775021, 0.72976, 0.688016, 0.649615, 0.614384, 0.58215, 0.552737, 0.525986, 0.501772, 0.47998, 0.460493, 0.443196, 0.42797, 0.414701, 0.403271, 0.393566, 0.385467, 0.378886, 0.373809, 0.370237, 0.368169, 0.367605, 0.368546, 0.37099, 0.374938, 0.380391, 0.387347, 0.395835, 0.40596, 0.417837, 0.431583, 0.447314, 0.465148, 0.4852, 0.507588, 0.532428, 0.559836, 0.589943, 0.622917, 0.65893, 0.698156, 0.740767, 0.786936, 0.836837, 0.890642, 0.948525, 1.01066, 1.07708, 1.14752, 1.22166, 1.29916, 1.37971, 1.46297, 1.54864, 1.63637, 1.72585, 1.81675, 1.90855, 2.00021, 2.09065, 2.17878, 2.2635, 2.34374, 2.41839, 2.48637, 2.54659, 2.59796, 2.63969, 2.6717, 2.69399, 2.70655, 2.70939, 2.7025, 2.68588, 2.65955, 2.62348, 2.5777, 2.52251, 2.45893, 2.38803, 2.31092, 2.22868, 2.14241, 2.05318, 1.9621, 1.87025, 1.77873, 1.68838, 1.59958, 1.51267, 1.42797, 1.3458, 1.26648, 1.19034, 1.11771, 1.0489, 0.984242, 0.923901, 0.867738, 0.81558, 0.767255, 0.72259, 0.68141, 0.643544, 0.608819, 0.57706, 0.548096, 0.521772, 0.497968, 0.476568, 0.457454, 0.44051, 0.42562, 0.412667, 0.401535, 0.392106, 0.384266, 0.377937, 0.373111, 0.36979, 0.367973, 0.367659, 0.36885, 0.371545, 0.375743, 0.381446, 0.388653, 0.397406, 0.407814, 0.419994, 0.434063, 0.450137, 0.468332, 0.488766, 0.511555, 0.536814, 0.564662, 0.595235, 0.628703, 0.66524, 0.705018, 0.74821, 0.794989, 0.845529, 0.900002, 0.958581, 1.02144, 1.08855, 1.15963, 1.23435, 1.31238, 1.39341, 1.47709, 1.56312, 1.65117, 1.74091, 1.83202, 1.92386, 2.0154, 2.10553, 2.19316, 2.27722, 2.3566, 2.43021, 2.49698, 2.5558, 2.60559, 2.6457, 2.67609, 2.69676, 2.7077, 2.70891, 2.7004, 2.68217, 2.65421, 2.61653, 2.56913, 2.51247, 2.44759, 2.37559, 2.29754, 2.21456, 2.12771, 2.0381, 1.94682, 1.85495, 1.76357, 1.67346, 1.58496, 1.49839, 1.41409, 1.33237, 1.25356, 1.17798, 1.10596, 1.03783, 0.973887, 0.914255, 0.858771, 0.807265, 0.759562, 0.715489, 0.674874, 0.637543, 0.603324, 0.572043, 0.543529, 0.517633, 0.494238, 0.473226, 0.454482, 0.437889, 0.42333, 0.410688, 0.399848, 0.390692, 0.383107, 0.377028, 0.372453, 0.369383, 0.367816, 0.367753, 0.369195, 0.37214, 0.376589, 0.382543, 0.390002, 0.399022, 0.409718, 0.422205, 0.4366, 0.453019, 0.471579, 0.492397, 0.51559, 0.541273, 0.569564, 0.600607, 0.634575, 0.67164, 0.711975, 0.755753, 0.803147, 0.85433, 0.909475, 0.968755, 1.03233, 1.10013, 1.17184, 1.24713, 1.32569, 1.40718, 1.49128, 1.57767, 1.66602, 1.75601, 1.8473, 1.93917, 2.03055, 2.12034, 2.20745, 2.2908, 2.3693, 2.44185, 2.50736, 2.56475, 2.61295, 2.65144, 2.68021, 2.69926, 2.70858, 2.70817, 2.69804, 2.67819, 2.64861, 2.6093, 2.5603, 2.5022, 2.43606, 2.36297, 2.28403, 2.20032, 2.11294, 2.02298, 1.93152, 1.83966, 1.74846, 1.65859, 1.57039, 1.48418, 1.40028, 1.31903, 1.24073, 1.16572, 1.09433, 1.02687, 0.963653, 0.904724, 0.849916, 0.799055, 0.751969, 0.708484, 0.668429, 0.631629, 0.597911, 0.567103, 0.539034, 0.513564, 0.490574, 0.469948, 0.45157, 0.435324, 0.421093, 0.40876, 0.398208, 0.389322, 0.381989, 0.376161, 0.371837, 0.369017, 0.367701, 0.367889, 0.369581, 0.372777, 0.377477, 0.383681, 0.391394, 0.400685, 0.411671, 0.424468, 0.439192, 0.45596, 0.474889, 0.496095, 0.519694, 0.545803, 0.574542, 0.606061, 0.640533, 0.678131, 0.719027, 0.763396, 0.811409, 0.863241, 0.919063, 0.979049, 1.04335, 1.11182, 1.18415, 1.26001, 1.33907, 1.42102, 1.50553, 1.59226, 1.68091, 1.77115, 1.8626, 1.95446, 2.04565, 2.13507, 2.22163, 2.30425, 2.38183, 2.45328, 2.51752, 2.57345, 2.62004, 2.65691, 2.68406, 2.70148, 2.70918, 2.70716, 2.69541, 2.67393, 2.64273, 2.60181, 2.55122, 2.4917, 2.42433, 2.35019, 2.27038, 2.18598, 2.0981, 2.00781, 1.91621, 1.82438, 1.73338, 1.64376, 1.55587, 1.47003, 1.38655, 1.30576, 1.22799, 1.15357, 1.0828, 1.01603, 0.953538, 0.895308, 0.841169, 0.79095, 0.744476, 0.701575, 0.662074, 0.6258, 0.592579, 0.56224, 0.534612, 0.509563, 0.486975, 0.466732, 0.448718, 0.432816, 0.418909, 0.406881, 0.396615, 0.387995, 0.380913, 0.375336, 0.371263, 0.368693, 0.367628, 0.368067, 0.370009, 0.373456, 0.378407, 0.384861, 0.39283, 0.402396, 0.413675, 0.426785, 0.441842, 0.458962, 0.478262, 0.499859, 0.523868, 0.550407, 0.579598, 0.611597, 0.646578, 0.684713, 0.726176, 0.771141, 0.819778, 0.872263, 0.928767, 0.989464, 1.05448, 1.12362, 1.19656, 1.27297, 1.35254, 1.43494, 1.51983, 1.60691, 1.69585, 1.78632, 1.87791, 1.96974, 2.06071, 2.14973, 2.23571, 2.31756, 2.3942, 2.46452, 2.52745, 2.58188, 2.62686, 2.66211, 2.68763, 2.70343, 2.70951, 2.70586, 2.69249, 2.6694, 2.63658, 2.59404, 2.5419, 2.481, 2.41243, 2.33728, 2.25664, 2.17159, 2.08322, 1.99264, 1.90091, 1.80914, 1.71831, 1.62893, 1.54133, 1.45582, 1.37275, 1.29243, 1.2152, 1.14139, 1.07131, 1.00531, 0.943633, 0.886212, 0.832858, 0.783382, 0.737596, 0.695314, 0.656349, 0.620511, 0.587615, 0.557473, 0.529913, 0.504849, 0.482218, 0.461956, 0.444002, 0.428292, 0.414765, 0.403357, 0.394006, 0.386649, 0.381204, 0.377496, 0.375324, 0.374488, 0.374785, 0.376014, 0.377975, 0.380466, 0.383286, 0.386235, 0.38927, 0.393064, 0.398484, 0.406397, 0.417671, 0.433172, 0.453768, 0.480327, 0.513716, 0.554801, 0.603898, 0.658987, 0.717442, 0.776632, 0.833929, 0.886704, 0.932328, 0.968171, 0.991605, 1];
plot(x,y,'r--');
x = [-3, -2.9, -2.8, -2.7, -2.6, -2.5, -2.4, -2.3, -2.2, -2.1, -2, -1.9, -1.8, -1.7, -1.6, -1.5, -1.4, -1.3, -1.2, -1.1, -1, -0.9, -0.8, -0.7, -0.6, -0.5, -0.4, -0.3, -0.2, -0.1, 0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1, 1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8, 2.9, 3];
y = [1, 1.8, 2.58844, 2.58844, 1.8, 1, 0.555556, 0.386333, 0.386333, 0.555556, 1, 1.8, 2.58844, 2.58844, 1.8, 1, 0.555556, 0.386333, 0.386333, 0.555556, 1, 1.8, 2.58844, 2.58844, 1.8, 1, 0.555556, 0.386333, 0.386333, 0.555556, 1, 1.8, 2.58844, 2.58844, 1.8, 1, 0.555556, 0.386333, 0.386333, 0.555556, 1, 1.8, 2.58844, 2.58844, 1.8, 1, 0.555556, 0.386333, 0.386333, 0.555556, 1, 1.8, 2.58844, 2.58844, 1.8, 1, 0.555556, 0.386333, 0.386333, 0.555556, 1];
plot(x,y,'ro');
x = [-3, 3];
y = [1, 1];
plot(x,y,'g*');
x = [-3, 3];
y = [1, 1];
plot(x,y,'k:');
legend('exp(sin(2*pi*x))','t0 to tn','Natural CSI','check findindex()','check corner cases');
hold off;
